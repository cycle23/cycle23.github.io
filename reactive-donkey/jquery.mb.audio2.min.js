var $jscomp={scope:{},IteratorResult:function(){},Iterator:function(){},Iterable:function(){}};$jscomp.Iterable.prototype.$$iterator=function(){};$jscomp.makeIterator=function(b){if(b.$$iterator)return b.$$iterator();if(!(b instanceof Array)&&"string"!=typeof b)throw Error();var k=0;return{next:function(){return k==b.length?{done:!0}:{done:!1,value:b[k++]}}}};$jscomp.copyProperties=function(b,k){for(var f in k)b[f]=k[f]};
$jscomp.inherits=function(b,k){function f(){}f.prototype=k.prototype;b.superClass_=k.prototype;b.prototype=new f;b.prototype.constructor=b;b.base=function(b,a,c){var d=Array.prototype.slice.call(arguments,2);return k.prototype[a].apply(b,d)}};
var ua=navigator.userAgent.toLowerCase(),isAndroid=/android/.test(ua),isiOs=/(iphone|ipod|ipad)/.test(ua),isStandAlone=window.navigator.standalone,isiPad=ua.match(/ipad/),isDevice="ontouchstart"in window,isChrome="chrome"in window,isMoz="mozAnimationStartTime"in window;String.prototype.asId=function(){return this.replace(/[^a-zA-Z0-9_]+/g,"")};function supportType(b){var k=document.createElement("audio");b=k.canPlayType&&k.canPlayType(b);return""===b?!1:!0}
(function(b){function k(a){this.name="string"===typeof a?a:a.mp3.split(".")[0].asId();this.soundInPlay=null;this.playingSounds=[];this.isMuted=!1;b.mbAudio.ch.push(this)}function f(a,c){var d=new Date,d=m(d.getHours())+":"+m(d.getMinutes())+":"+m(d.getSeconds())+" >> "+a;b("#console").append("<p>"+d+"</p>");console.log(d);c&&alert(d)}function m(a){return 10>a?"0"+a:""+a}b.mbAudio={name:"mb.audio",author:"Matteo Bicocchi",version:"1.5",defaults:{id:"",ogg:"",mp3:"",loop:!1,volume:10},sounds:{},players:{},
loaded:{},playing:[],ch:[],soundsMutedByHand:!1,build:function(a){b.mbAudio.isInit||(b(window).on("blur",function(){f("blur, muteall");b.mbAudio.soundsMutedByHand=!0;b.mbAudio.muteAllSounds()}).on("focus",function(){f("focus, unmuteall");b.mbAudio.soundsMutedByHand=!1;b.mbAudio.unMuteAllSounds()}),f("isInit"),b.mbAudio.isInit=!0);var c="string"===typeof a?b.mbAudio.sounds[a]:a,d=c.id?c.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();if(1!==b.mbAudio.loaded[d]){f("load "+d);var e=supportType("audio/mpeg")?
c.mp3:c.ogg;b.mbAudio.players[d]=new Audio(e);b.mbAudio.players[d].load();b.mbAudio.players[d].pause();b.mbAudio.players[d].addEventListener("error",function(){f("Audio error: "+e+"; "+JSON.stringify(b.mbAudio.players[d].error),!0)});b.mbAudio.players[d].addEventListener("play",function(){f("Starting audio: "+e+"; MIME-type: "+b.mbAudio.players[d].type,!1)});b.mbAudio.players[d].addEventListener("ended",function(){f("Playback ended: "+e,!1)});b.mbAudio.players[d].addEventListener("canplay",function(){f("canplay"+
e,!1)});b.mbAudio.loaded[d]=1}},getPlayer:function(a){var c=document.getElementById("mbAudio_"+a);0!==b(c).length&&b.mbAudio.players[a]||(a="string"===typeof a?b.mbAudio.sounds[a]:a,a=a.id?a.id:"string"===typeof sound?sound:sound.mp3.split(".")[0].asId());return b.mbAudio.players[a]},preload:function(){for(var a in b.mbAudio.sounds)b.mbAudio.build(a);alert("preload triggering soundsLoaded");b(document).trigger("soundsLoaded")},play:function(a,c,d){var e="string"===typeof a?b.mbAudio.sounds[a]:a;if(e){var l=
e.id?e.id:"string"===typeof a?a:a.mp3.split(".")[0].asId(),g=e.loop?e.loop:b.mbAudio.defaults.loop,k="number"===typeof e.volume?e.volume:b.mbAudio.defaults.volume,k=10<k?10:k;b.mbAudio.build(a);var h=b.mbAudio.getPlayer(l);h.vol=k;h.volume=b.mbAudio.allMuted?0:h.vol/10;f("volume "+h.volume);b(h).off("ended."+l+",paused."+l);"undefined"===typeof c&&(c=!0);if(!c||"string"!==typeof c&&"object"!==typeof c){f("not sure how here");if(g)b(h).one("ended."+l+",paused."+l,function(){this.currentTime=0;if("number"===
typeof g&&("undefined"===typeof h.counter&&(h.counter=0),h.counter++,h.counter===g)){delete h.counter;b.mbAudio.playing.splice(l,1);delete h.isPlaying;"function"===typeof d&&d(h);return}b.mbAudio.play(a,c,d)});else f("ended"),b(h).on("ended."+l+",paused."+l,function(){b.mbAudio.playing.splice(l,1);delete h.isPlaying;"function"===typeof d&&d(h)});f("pausing");h.pause();h.currentTime&&c&&(f("time to 0"),h.currentTime=0);f(".. call to play");h.play();e=jQuery.inArray(l,b.mbAudio.playing);b.mbAudio.playing.splice(e,
1);b.mbAudio.playing.push(l);h.isPlaying=!0;f("returning")}else if(c="string"===typeof c?e.sprite[c]:c,clearTimeout(h.timeOut),isAndroid||0!==h.seekable.length)f("manage direct"),b.mbAudio.manageSprite(h,l,a,c,d);else{h.pause();f("paused seekable length is 0");var p=setInterval(function(){0<h.seekable.length&&h.seekable.end(0)>=c.end-1?(clearInterval(p),f("managing sprite from seekable interval "+l),f("seekable.length: "+h.seekable.length),f("index 0: "+h.seekable.end(0)),f("sprite.end: "+c.end),
f("sprite.end - 1: "+(c.end-1)),b.mbAudio.manageSprite(h,l,a,c,d)):f("no manage")},1)}}},manageSprite:function(a,c,d,e,l){function g(a,b,d,c,e){a.currentTime=c.start;f("checkStart set: "+a.currentTime+", "+c.start);Math.round(a.currentTime)!=Math.round(c.start)?(f("call again "+b+", "+a.currentTime+" != "+c.start),g(a,b,d,c,e)):(f("playerPlay "+b),k(a,b,d,c,e))}function k(a,d,c,e,g){var l=1E3*(e.end-e.start)+100;f("delay: "+l);var n=!0;a.play();a.isPlaying=!0;a.timeOut=setTimeout(function(){e.loop?
(n=!1,e.loop=!0===e.loop?9999:e.loop,a.counter||(a.counter=1),a.counter!==e.loop&&a.isPlaying?(a.counter++,a.currentTime=e.start||0,b.mbAudio.play(c,e,g)):(a.counter=0,n=!0,a.pause(),delete a.isPlaying)):(f("pause timeout"),a.pause(),delete a.isPlaying);n&&"function"===typeof g&&g(a);var l=jQuery.inArray(d,b.mbAudio.playing);b.mbAudio.playing.splice(l,1)},l);b.mbAudio.playing.push(d);a.isPlaying=!0}f("> manage "+c);a.pause();g(a,c,d,e,l)},stop:function(a,c){if(a){var d="string"===typeof a?b.mbAudio.sounds[a]:
a;if(d){var e=d.id?d.id:"string"===typeof a?a:a.mp3.split(".")[0].asId(),d=b.mbAudio.getPlayer(e);1!==b.mbAudio.loaded[e]&&b.mbAudio.build(a);d.pause();d.currentTime&&(d.currentTime=0);b(d).off("ended."+e);"function"===typeof c&&c(d);e=jQuery.inArray(e,b.mbAudio.playing);b.mbAudio.playing.splice(e,1);delete d.isPlaying;delete d.counter}}},pause:function(a,c){var d="string"===typeof a?b.mbAudio.sounds[a]:a,e=d.id?d.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();1!==b.mbAudio.loaded[e]&&b.mbAudio.build(a);
d=b.mbAudio.getPlayer(e);d.pause();b(d).off("ended."+e);e=jQuery.inArray(e,b.mbAudio.playing);-1<e&&b.mbAudio.playing.splice(e,1);delete d.isPlaying;delete d.counter;clearTimeout(d.timeOut);"function"===typeof c&&c()},destroy:function(a){var c="string"===typeof a?b.mbAudio.sounds[a]:a;a=c.id?c.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();b.mbAudio.loaded[a]=0;c=jQuery.inArray(a,b.mbAudio.playing);b.mbAudio.playing.splice(c,1);(a=b.mbAudio.getPlayer(a))&&b(a).remove()},muteAllSounds:function(){var a=
b.mbAudio.loaded;if(a){for(var c in a)a=b.mbAudio.getPlayer(c),a.vol=10*a.volume,a.volume=0;b.mbAudio.allMuted=!0}},unMuteAllSounds:function(){var a=b.mbAudio.loaded;if(a){for(var c in a)a=b.mbAudio.getPlayer(c),a.volume=a.vol/10;b.mbAudio.allMuted=!1}},stopAllSounds:function(){var a=b.mbAudio.loaded;if(a){for(var c in a)b.mbAudio.destroy(c);b.mbAudio.allMuted=!0}},setVolume:function(a,c){var d="string"===typeof a?b.mbAudio.sounds[a]:a,d=d.id?d.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();
1!==b.mbAudio.loaded[d]&&b.mbAudio.build(a);d=b.mbAudio.getPlayer(d);d.vol=10<c?10:c;d.volume=d.vol},fadeIn:function(a,c,d,e){d||(d=3E3);d/=4;c="string"===typeof a?b.mbAudio.sounds[a]:a;var l=c.id?c.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();1!==b.mbAudio.loaded[l]&&b.mbAudio.build(a);var g=b.mbAudio.getPlayer(l),f="number"===typeof c.volume?c.volume:b.mbAudio.defaults.volume,f=10<f?10:f,h=f/10/d;clearInterval(g.fade);g.play();g.currentTime&&(g.currentTime=0);g.volume=0;if(!b.mbAudio.allMuted){var k=
0;g.fade=setInterval(function(){k>=f/10?(clearInterval(g.fade),"function"===typeof e&&e(g)):(g.volume=k,k+=h)},0)}b.mbAudio.playing.push(l);g.isPlaying=!0},fadeOut:function(a,c,d){c||(c=3E3);c/=4;var e="string"===typeof a?b.mbAudio.sounds[a]:a,f=e.id?e.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();1!==b.mbAudio.loaded[f]&&b.mbAudio.build(a);var g=b.mbAudio.getPlayer(f);a=g.volume?10*g.volume:"number"===typeof e.volume?e.volume:b.mbAudio.defaults.volume;a=10<a?10:a;var k=a/10/c;clearInterval(g.fade);
g.volume=a/10;g.play();var h=g.volume;g.fade=setInterval(function(){if(0>=h){h=0;clearInterval(g.fade);g.volume=0;g.isPlaying=!1;var a=jQuery.inArray(f,b.mbAudio.playing);b.mbAudio.playing.splice(a,1);g.pause();"function"===typeof d&&d(g)}else g.volume=h,h-=k},0)},queue:{isStarted:!1,add:function(a,c,d,e){var f="string"===typeof a?a:a.mp3.split(".")[0].asId(),f=b.mbAudio.queue.get(f);null===f&&(f=new k(a));var g="string"===typeof a?b.mbAudio.sounds[a]:a;g.started||(b.mbAudio.pause(a),g.started=!0);
c="string"===typeof c?g.sprite[c]:c;g={};g.soundID=a;g.sprite=c;g.channel=f;g.hasPriority=e;g.callback=d;b.mbAudio.queue.isStarted||b.mbAudio.queue.startEngine();b.mbAudio.soundsMutedByHand||(g.hasPriority?(g.channel.playingSounds.splice(0,1),g.channel.soundInPlay=null,f.playingSounds.unshift(g)):f.playingSounds.push(g))},get:function(a){for(var c in b.mbAudio.ch)if(b.mbAudio.ch[c].name===a)return b.mbAudio.ch[c]},manage:function(){function a(a){null===a.soundInPlay&&a.playingSounds&&0<a.playingSounds.length&&
!b.mbAudio.soundsMutedByHand&&!a.isMuted?(a.soundInPlay=a.playingSounds[0],b.mbAudio.play(a.soundInPlay.soundID,a.soundInPlay.sprite,function(){"function"===typeof a.soundInPlay.callback&&a.soundInPlay.callback();a.playingSounds.splice(0,1);a.soundInPlay=null})):null!==a.soundInPlay&&a.soundInPlay.soundID&&(b.mbAudio.soundsMutedByHand||a.isMuted)&&(b.mbAudio.pause(a.soundInPlay.soundID),a.playingSounds=[],a.playingSounds.unshift(a.soundInPlay),a.soundInPlay=null)}for(var c in b.mbAudio.ch)a(b.mbAudio.ch[c])},
mute:function(a){if(a){var c=b.mbAudio.queue.get(a);c&&(c.isMuted=!0);b.mbAudio.pause(a)}else b.mbAudio.soundsMutedByHand=!0},unMute:function(a){if(a){if(a=b.mbAudio.queue.get(a))a.isMuted=!1}else b.mbAudio.soundsMutedByHand=!1},clear:function(a){if(a=b.mbAudio.queue.get(a))null!==a.soundInPlay&&b.mbAudio.pause(a.soundInPlay.soundID),a.soundInPlay=null,a.playingSounds=[]},startEngine:function(){b.mbAudio.channelsEngine=setInterval(b.mbAudio.queue.manage,1);b.mbAudio.queue.isStarted=!0},stopEngine:function(){clearInterval(b.mbAudio.channelsEngine);
b.mbAudio.queue.isStarted=!1}}}})(jQuery);
