var $jscomp={scope:{},IteratorResult:function(){},Iterator:function(){},Iterable:function(){}};$jscomp.Iterable.prototype.$$iterator=function(){};$jscomp.makeIterator=function(b){if(b.$$iterator)return b.$$iterator();if(!(b instanceof Array)&&"string"!=typeof b)throw Error();var k=0;return{next:function(){return k==b.length?{done:!0}:{done:!1,value:b[k++]}}}};$jscomp.copyProperties=function(b,k){for(var f in k)b[f]=k[f]};
$jscomp.inherits=function(b,k){function f(){}f.prototype=k.prototype;b.superClass_=k.prototype;b.prototype=new f;b.prototype.constructor=b;b.base=function(b,a,d){var c=Array.prototype.slice.call(arguments,2);return k.prototype[a].apply(b,c)}};
var ua=navigator.userAgent.toLowerCase(),isAndroid=/android/.test(ua),isiOs=/(iphone|ipod|ipad)/.test(ua),isStandAlone=window.navigator.standalone,isiPad=ua.match(/ipad/),isDevice="ontouchstart"in window,isChrome="chrome"in window,isMoz="mozAnimationStartTime"in window;String.prototype.asId=function(){return this.replace(/[^a-zA-Z0-9_]+/g,"")};function supportType(b){var k=document.createElement("audio");b=k.canPlayType&&k.canPlayType(b);return""===b?!1:!0}
(function(b){function k(a){this.name="string"===typeof a?a:a.mp3.split(".")[0].asId();this.soundInPlay=null;this.playingSounds=[];this.isMuted=!1;b.mbAudio.ch.push(this)}function f(a,d){var c=new Date,c=n(c.getHours())+":"+n(c.getMinutes())+":"+n(c.getSeconds())+" >> "+a;b("#console").append("<p>"+c+"</p>");console.log(c);d&&alert(c)}function n(b){return 10>b?"0"+b:""+b}b.mbAudio={name:"mb.audio",author:"Matteo Bicocchi",version:"1.5",defaults:{id:"",ogg:"",mp3:"",loop:!1,volume:10},sounds:{},players:{},
loaded:{},playing:[],ch:[],soundsMutedByHand:!1,build:function(a){b.mbAudio.isInit||(b(window).on("blur",function(){f("blur, muteall");b.mbAudio.soundsMutedByHand=!0;b.mbAudio.muteAllSounds()}).on("focus",function(){f("focus, unmuteall");b.mbAudio.soundsMutedByHand=!1;b.mbAudio.unMuteAllSounds()}),f("isInit"),b.mbAudio.isInit=!0);var d="string"===typeof a?b.mbAudio.sounds[a]:a,c=d.id?d.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();if(1!==b.mbAudio.loaded[c]){f("load "+c);var e=supportType("audio/mpeg")?
d.mp3:d.ogg;b.mbAudio.players[c]=new Audio(e);b.mbAudio.players[c].addEventListener("error",function(){f("Audio error: "+e+"; "+JSON.stringify(b.mbAudio.players[c].error),!0)});b.mbAudio.players[c].addEventListener("play",function(){f("Starting audio: "+e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("pause",function(){f("pause audio: "+e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("timeupdate",function(){f("timeupdate audio: "+
e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("loadedmetadata",function(){f("loaded metadata audio: "+e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("durationchange",function(){f("durationchange audio: "+e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("loadeddata",function(){f("loaded data audio: "+e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("startloading",
function(){f("startloading audio: "+e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("progress",function(){f("progress audio: "+e+"; MIME-type: "+b.mbAudio.players[c].type,!1)});b.mbAudio.players[c].addEventListener("ended",function(){f("Playback ended: "+e,!1)});b.mbAudio.players[c].addEventListener("canplay",function(){f("canplay"+e,!1)});b.mbAudio.players[c].load();b.mbAudio.players[c].pause();b.mbAudio.loaded[c]=1}},getPlayer:function(a){var d=document.getElementById("mbAudio_"+
a);0!==b(d).length&&b.mbAudio.players[a]||(a="string"===typeof a?b.mbAudio.sounds[a]:a,a=a.id?a.id:"string"===typeof sound?sound:sound.mp3.split(".")[0].asId());return b.mbAudio.players[a]},preload:function(){for(var a in b.mbAudio.sounds)b.mbAudio.build(a);alert("preload triggering soundsLoaded");b(document).trigger("soundsLoaded")},play:function(a,d,c){var e="string"===typeof a?b.mbAudio.sounds[a]:a;if(e){var l=e.id?e.id:"string"===typeof a?a:a.mp3.split(".")[0].asId(),g=e.loop?e.loop:b.mbAudio.defaults.loop,
k="number"===typeof e.volume?e.volume:b.mbAudio.defaults.volume,k=10<k?10:k;b.mbAudio.build(a);var h=b.mbAudio.getPlayer(l);h.vol=k;h.volume=b.mbAudio.allMuted?0:h.vol/10;f("volume "+h.volume);b(h).off("ended."+l+",paused."+l);"undefined"===typeof d&&(d=!0);if(!d||"string"!==typeof d&&"object"!==typeof d){f("not sure how here");if(g)b(h).one("ended."+l+",paused."+l,function(){this.currentTime=0;if("number"===typeof g&&("undefined"===typeof h.counter&&(h.counter=0),h.counter++,h.counter===g)){delete h.counter;
b.mbAudio.playing.splice(l,1);delete h.isPlaying;"function"===typeof c&&c(h);return}b.mbAudio.play(a,d,c)});else f("ended"),b(h).on("ended."+l+",paused."+l,function(){b.mbAudio.playing.splice(l,1);delete h.isPlaying;"function"===typeof c&&c(h)});f("pausing");h.pause();h.currentTime&&d&&(f("time to 0"),h.currentTime=0);f(".. call to play");h.play();e=jQuery.inArray(l,b.mbAudio.playing);b.mbAudio.playing.splice(e,1);b.mbAudio.playing.push(l);h.isPlaying=!0;f("returning")}else if(d="string"===typeof d?
e.sprite[d]:d,clearTimeout(h.timeOut),isAndroid||0!==h.seekable.length)f("manage direct"),b.mbAudio.manageSprite(h,l,a,d,c);else{h.pause();f("paused seekable length is 0");var m=setInterval(function(){0<h.seekable.length&&h.seekable.end(0)>=d.end-1?(clearInterval(m),f("managing sprite from seekable interval "+l),f("seekable.length: "+h.seekable.length),f("index 0: "+h.seekable.end(0)),f("sprite.end: "+d.end),f("sprite.end - 1: "+(d.end-1)),b.mbAudio.manageSprite(h,l,a,d,c)):f("no manage")},1)}}},
manageSprite:function(a,d,c,e,l){function g(b,a,c,d,e){b.currentTime=d.start;f("checkStart set: "+b.currentTime+", "+d.start);Math.round(b.currentTime)!=Math.round(d.start)?(f("call again "+a+", "+b.currentTime+" != "+d.start),g(b,a,c,d,e)):(f("playerPlay "+a),k(b,a,c,d,e))}function k(a,c,d,e,g){var l=1E3*(e.end-e.start)+100;f("delay: "+l);var p=!0;a.play();a.isPlaying=!0;a.timeOut=setTimeout(function(){e.loop?(p=!1,e.loop=!0===e.loop?9999:e.loop,a.counter||(a.counter=1),a.counter!==e.loop&&a.isPlaying?
(a.counter++,a.currentTime=e.start||0,b.mbAudio.play(d,e,g)):(a.counter=0,p=!0,a.pause(),delete a.isPlaying)):(f("pause timeout"),a.pause(),delete a.isPlaying);p&&"function"===typeof g&&g(a);var l=jQuery.inArray(c,b.mbAudio.playing);b.mbAudio.playing.splice(l,1)},l);b.mbAudio.playing.push(c);a.isPlaying=!0}f("> manage "+d);a.pause();g(a,d,c,e,l)},stop:function(a,d){if(a){var c="string"===typeof a?b.mbAudio.sounds[a]:a;if(c){var e=c.id?c.id:"string"===typeof a?a:a.mp3.split(".")[0].asId(),c=b.mbAudio.getPlayer(e);
1!==b.mbAudio.loaded[e]&&b.mbAudio.build(a);c.pause();c.currentTime&&(c.currentTime=0);b(c).off("ended."+e);"function"===typeof d&&d(c);e=jQuery.inArray(e,b.mbAudio.playing);b.mbAudio.playing.splice(e,1);delete c.isPlaying;delete c.counter}}},pause:function(a,d){var c="string"===typeof a?b.mbAudio.sounds[a]:a,e=c.id?c.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();1!==b.mbAudio.loaded[e]&&b.mbAudio.build(a);c=b.mbAudio.getPlayer(e);c.pause();b(c).off("ended."+e);e=jQuery.inArray(e,b.mbAudio.playing);
-1<e&&b.mbAudio.playing.splice(e,1);delete c.isPlaying;delete c.counter;clearTimeout(c.timeOut);"function"===typeof d&&d()},destroy:function(a){var d="string"===typeof a?b.mbAudio.sounds[a]:a;a=d.id?d.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();b.mbAudio.loaded[a]=0;d=jQuery.inArray(a,b.mbAudio.playing);b.mbAudio.playing.splice(d,1);(a=b.mbAudio.getPlayer(a))&&b(a).remove()},muteAllSounds:function(){var a=b.mbAudio.loaded;if(a){for(var d in a)a=b.mbAudio.getPlayer(d),a.vol=10*a.volume,a.volume=
0;b.mbAudio.allMuted=!0}},unMuteAllSounds:function(){var a=b.mbAudio.loaded;if(a){for(var d in a)a=b.mbAudio.getPlayer(d),a.volume=a.vol/10;b.mbAudio.allMuted=!1}},stopAllSounds:function(){var a=b.mbAudio.loaded;if(a){for(var d in a)b.mbAudio.destroy(d);b.mbAudio.allMuted=!0}},setVolume:function(a,d){var c="string"===typeof a?b.mbAudio.sounds[a]:a,c=c.id?c.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();1!==b.mbAudio.loaded[c]&&b.mbAudio.build(a);c=b.mbAudio.getPlayer(c);c.vol=10<d?10:d;c.volume=
c.vol},fadeIn:function(a,d,c,e){c||(c=3E3);c/=4;d="string"===typeof a?b.mbAudio.sounds[a]:a;var f=d.id?d.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();1!==b.mbAudio.loaded[f]&&b.mbAudio.build(a);var g=b.mbAudio.getPlayer(f),k="number"===typeof d.volume?d.volume:b.mbAudio.defaults.volume,k=10<k?10:k,h=k/10/c;clearInterval(g.fade);g.play();g.currentTime&&(g.currentTime=0);g.volume=0;if(!b.mbAudio.allMuted){var m=0;g.fade=setInterval(function(){m>=k/10?(clearInterval(g.fade),"function"===typeof e&&
e(g)):(g.volume=m,m+=h)},0)}b.mbAudio.playing.push(f);g.isPlaying=!0},fadeOut:function(a,d,c){d||(d=3E3);d/=4;var e="string"===typeof a?b.mbAudio.sounds[a]:a,f=e.id?e.id:"string"===typeof a?a:a.mp3.split(".")[0].asId();1!==b.mbAudio.loaded[f]&&b.mbAudio.build(a);var g=b.mbAudio.getPlayer(f);a=g.volume?10*g.volume:"number"===typeof e.volume?e.volume:b.mbAudio.defaults.volume;a=10<a?10:a;var k=a/10/d;clearInterval(g.fade);g.volume=a/10;g.play();var h=g.volume;g.fade=setInterval(function(){if(0>=h){h=
0;clearInterval(g.fade);g.volume=0;g.isPlaying=!1;var a=jQuery.inArray(f,b.mbAudio.playing);b.mbAudio.playing.splice(a,1);g.pause();"function"===typeof c&&c(g)}else g.volume=h,h-=k},0)},queue:{isStarted:!1,add:function(a,d,c,e){var f="string"===typeof a?a:a.mp3.split(".")[0].asId(),f=b.mbAudio.queue.get(f);null===f&&(f=new k(a));var g="string"===typeof a?b.mbAudio.sounds[a]:a;g.started||(b.mbAudio.pause(a),g.started=!0);d="string"===typeof d?g.sprite[d]:d;g={};g.soundID=a;g.sprite=d;g.channel=f;g.hasPriority=
e;g.callback=c;b.mbAudio.queue.isStarted||b.mbAudio.queue.startEngine();b.mbAudio.soundsMutedByHand||(g.hasPriority?(g.channel.playingSounds.splice(0,1),g.channel.soundInPlay=null,f.playingSounds.unshift(g)):f.playingSounds.push(g))},get:function(a){for(var d in b.mbAudio.ch)if(b.mbAudio.ch[d].name===a)return b.mbAudio.ch[d]},manage:function(){function a(a){null===a.soundInPlay&&a.playingSounds&&0<a.playingSounds.length&&!b.mbAudio.soundsMutedByHand&&!a.isMuted?(a.soundInPlay=a.playingSounds[0],b.mbAudio.play(a.soundInPlay.soundID,
a.soundInPlay.sprite,function(){"function"===typeof a.soundInPlay.callback&&a.soundInPlay.callback();a.playingSounds.splice(0,1);a.soundInPlay=null})):null!==a.soundInPlay&&a.soundInPlay.soundID&&(b.mbAudio.soundsMutedByHand||a.isMuted)&&(b.mbAudio.pause(a.soundInPlay.soundID),a.playingSounds=[],a.playingSounds.unshift(a.soundInPlay),a.soundInPlay=null)}for(var d in b.mbAudio.ch)a(b.mbAudio.ch[d])},mute:function(a){if(a){var d=b.mbAudio.queue.get(a);d&&(d.isMuted=!0);b.mbAudio.pause(a)}else b.mbAudio.soundsMutedByHand=
!0},unMute:function(a){if(a){if(a=b.mbAudio.queue.get(a))a.isMuted=!1}else b.mbAudio.soundsMutedByHand=!1},clear:function(a){if(a=b.mbAudio.queue.get(a))null!==a.soundInPlay&&b.mbAudio.pause(a.soundInPlay.soundID),a.soundInPlay=null,a.playingSounds=[]},startEngine:function(){b.mbAudio.channelsEngine=setInterval(b.mbAudio.queue.manage,1);b.mbAudio.queue.isStarted=!0},stopEngine:function(){clearInterval(b.mbAudio.channelsEngine);b.mbAudio.queue.isStarted=!1}}}})(jQuery);
