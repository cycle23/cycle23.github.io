var $jscomp={scope:{},IteratorResult:function(){},Iterator:function(){},Iterable:function(){}};$jscomp.Iterable.prototype.$$iterator=function(){};$jscomp.makeIterator=function(a){if(a.$$iterator)return a.$$iterator();if(!(a instanceof Array)&&"string"!=typeof a)throw Error();var b=0;return{next:function(){return b==a.length?{done:!0}:{done:!1,value:a[b++]}}}};$jscomp.copyProperties=function(a,b){for(var c in b)a[c]=b[c]};
$jscomp.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,e){var g=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,g)}};var canvas=document.getElementById("canvas");function extend(a,b){for(var c in b)a[c]=b[c]}function assoc(){for(var a={},b=0;b<arguments.length;b++)extend(a,arguments[b]);return a}function coordBI(a,b){return a+(b||0)|0}
function onscreen(a){return!(-300>a.x||-1E3>a.y||1E3<a.y)}function velocity(a){return assoc(a,{x:a.x+a.vx,y:a.y+a.vy})}function intersects(a,b){var c=coordBI(b.x,b.baseX),d=coordBI(a.x,a.baseX),f=coordBI(b.y,b.baseY),e=coordBI(a.y,a.baseY);return 100>Math.abs(d-c)&&100>Math.abs(e-f)}function makeElement(a){return React.DOM.div({className:a.id,style:{left:a.x+(a.baseX||0)|NaN,top:a.y+(a.baseY||0)|NaN}},a.text)}
function renderScene(a){return React.renderComponent(React.DOM.div(null,a.map(makeElement)),canvas)}function bindKey(a){var b=new Rx.Subject;Mousetrap.bind(a,function(){b.onNext(a)});return b}
var tick=bindKey("space").buffer(Rx.Observable.interval(33)),groundStream=Rx.Observable.interval(33).map(function(a){return{id:"ground",baseX:0,y:320,x:a%280*-8}}),initialHater={id:"hater",vx:-8,vy:0,x:1600,y:300},haterStream=tick.scan(initialHater,function(a,b){a=velocity(a);return onscreen(a)?a:initialHater}),pinkieStream=Rx.Observable.zipArray(tick,haterStream).scan({id:"pinkie",baseY:320,x:0,y:0,vx:0,vy:0,points:0,gameOver:!1},function(a,b){var c=b[0],d=b[1];a=velocity(a);intersects(a,d)&&(a.gameOver=
!0,a.id="pinkie gameover",a.points=0,a.vy=-20,(new Audio("../../media/sound/gameover.mp3")).play());if(a.gameOver)return a.vy+=.5,a.points+=1,a;a.vy+=.98;0<=a.y&&0<a.vy&&(a.id="pinkie",a.y=0,a.vy=0);"space"===c[0]&&0===a.y&&(a.id="pinkie jumping",a.vy=-20,(new Audio("../../media/sound/jump.mp3")).play());return a}).takeWhile(onscreen),initialCoin={id:"coin",vx:-6,vy:0,x:1600,y:40},coinStream=pinkieStream.scan(initialCoin,function(a,b){a=velocity(a);0>a.vy&&(a.vy*=2);0===a.vy&&intersects(a,b)&&((new Audio("../../media/sound/coin.mp3")).play(),
a.vx=0,a.vy=-1);return onscreen(a)?a:initialCoin}),initialStat={id:"stat",x:0,y:0,points:0,text:"Init.."},statStream=coinStream.scan(initialStat,function(a,b){-1===b.vy&&(a.points+=1);a.text="Points: "+a.points;return a});Rx.Observable.zipArray(groundStream,pinkieStream,coinStream,statStream,haterStream).subscribe(renderScene);
