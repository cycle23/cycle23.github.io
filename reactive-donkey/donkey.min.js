var $jscomp={scope:{},IteratorResult:function(){},Iterator:function(){},Iterable:function(){}};$jscomp.Iterable.prototype.$$iterator=function(){};$jscomp.makeIterator=function(a){if(a.$$iterator)return a.$$iterator();if(!(a instanceof Array)&&"string"!=typeof a)throw Error();var b=0;return{next:function(){return b==a.length?{done:!0}:{done:!1,value:a[b++]}}}};$jscomp.copyProperties=function(a,b){for(var c in b)a[c]=b[c]};
$jscomp.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,e){var d=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,d)}};function extend(a,b){for(var c in b)a[c]=b[c]}function assoc(){for(var a={},b=0;b<arguments.length;b++)extend(a,arguments[b]);return a}function onscreen(a){return!(-300>a.x||-1E3>a.y||1E3<a.y)}
function bindKey(a){var b=new Rx.Subject;Mousetrap.bind(a,function(){b.onNext(a)});return b}function updateElement(a){$(a.id).attr("class",a.classes||"").css({left:a.x+(a.baseX||0)|NaN,top:a.y+(a.baseY||0)|NaN})}function renderScene(a){a.forEach(updateElement)}var canvas=$("#canvas");$("<div id='ground'></div>").appendTo(canvas);$("<div id='pinkie'></div>").appendTo(canvas);$("<div id='coin'></div>").appendTo(canvas);
var tick=bindKey("space").buffer(Rx.Observable.interval(33)),groundStream=Rx.Observable.interval(33).map(function(a){return{id:"#ground",baseX:-128,y:320,x:a%320*-8}}),pinkieStream=tick.scan({id:"#pinkie",baseY:320,x:0,y:0,vx:0,vy:0},function(a,b){a=velocity(a);a.vy+=.98;0<=a.y&&0<a.vy&&(a.y=0,a.vy=0);"space"===b[0]&&0===a.y&&(a.vy=-20,(new Audio("../purescript-magic/sfx/jump.ogg")).play());return a}).takeWhile(onscreen),initialCoin={id:"#coin",vx:-6,vy:0,x:1600,y:40},coinStream=pinkieStream.scan(initialCoin,
function(a,b){a=velocity(a);0>a.vy&&(a.vy*=2);return onscreen(a)?a:initialCoin});function velocity(a){return assoc(a,{x:a.x+a.vx,y:a.y+a.vy})}Rx.Observable.zipArray(groundStream,pinkieStream,coinStream).subscribe(renderScene);
